#!/bin/sh
#
# Concatenate years -> decades, decades -> all
#
if [ $# -ne 0 ] ; then
  echo "Usage: concatenate_data"
  exit 1
fi
#
cd $PROCDIR
#
if [ $DO_PROC -ne 0 ] ; then
  cd ${PROCDIR}
  for e in `ls -d *d.d` ; do
    cd ${PROCDIR}/${e}
    ../var_mon_to_year
    ../var_year_to_all
    if [ $? -eq 0 ] ; then
      mv *.${YEARBEG}*cat*${YEAREND}*.nc $CACHEDIR
    else
      echo "Error from var_year_to_all"
      exit 1
    fi
    cd ${PROCDIR}
  done
  cd ${PROCDIR}
fi
#
if [ $DO_IPCC -ne 0 ] ; then
  if [ $TYPE -eq "cm3" ] ; then
    cd ${PROCDIR}/IPCC
    ./cm3_var_mon_to_year
    ./cm3_var_year_to_all
    if [ $? -eq 0 ] ; then
      mv *.${YEARBEG}*cat*${YEAREND}*.nc $CACHEDIR
    else
      echo "Error from cm3_var_year_to_all"
      exit 1
    fi
  fi
  if [ $TYPE -eq "cm5" ] ; then
    cd ${PROCDIR}/CMIP5_data
    ./cm5_var_mon_to_year
    ./cm5_var_year_to_all
    if [ $? -eq 0 ] ; then
      mv *.${YEARBEG}*${YEAREND}*.nc $CACHEDIR
    else
      echo "Error from cm5_var_year_to_all"
      exit 1
    fi
  fi
fi
