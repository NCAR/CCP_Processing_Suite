head	1.1;
access;
symbols;
locks;
comment	@# @;


1.1
date	2015.01.22.23.28.59;	author strandwg;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Initial revision
@
text
@program drive_zonal
  !
  ! Compute zonal mean of data using 'gw' from data
  !
  implicit none
  !
  integer,parameter::real8 = selected_real_kind(15,128)
  integer::i,j
!  real,dimension(144,96)::data2d
  real(real8),dimension(144,96)::data2d
  real(real8),dimension(96)::gw,zonal
  !
  gw = (/0.000136695007530996, 0.00109333584416416, 0.002185476141635, &
    0.0032752266530317, 0.00436139575216965, 0.00544279572908613, &
    0.00651824408878299, 0.00758656484426889, 0.00864658980248234, &
    0.00969715984169461, 0.0107371261789923, 0.0117653516264541, &
    0.0127807118346497, 0.0137820965220986, 0.0147684106893471, &
    0.0157385758163346, 0.0166915310417382, 0.0176262343230105, &
    0.0185416635758361, 0.0194368177917678, 0.0203107181328123, &
    0.0211624090017778, 0.0219909590872031, 0.0227954623817345, &
    0.0235750391728312, 0.0243288370047177, 0.0250560316105318, &
    0.0257558278136486, 0.0264274603971946, 0.0270701949408004, &
    0.0276833286236791, 0.0282661909931501, 0.0288181446977701, &
    0.029338586184267, 0.0298269463575161, 0.0302826912028381, &
    0.0307053223699359, 0.0310943777178331, 0.0314494318202186, &
    0.031770096430645, 0.0320560209070681, 0.0323068925952713, &
    0.0325224371707465, 0.0327024189386649, 0.0328466410916061, &
    0.0329549459247632, 0.0330272150083913, 0.0330633693173083, &
    0.0330633693173082, 0.0330272150083912, 0.0329549459247632, &
    0.0328466410916062, 0.0327024189386651, 0.0325224371707464, &
    0.0323068925952712, 0.0320560209070681, 0.0317700964306451, &
    0.0314494318202188, 0.031094377717833, 0.0307053223699357, &
    0.0302826912028381, 0.0298269463575162, 0.0293385861842671, &
    0.0288181446977702, 0.0282661909931499, 0.0276833286236791, &
    0.0270701949408004, 0.0264274603971947, 0.0257558278136487, &
    0.0250560316105317, 0.0243288370047176, 0.0235750391728311, &
    0.0227954623817346, 0.0219909590872033, 0.0211624090017778, &
    0.0203107181328123, 0.0194368177917678, 0.0185416635758361, &
    0.0176262343230104, 0.0166915310417383, 0.0157385758163346, &
    0.014768410689347, 0.0137820965220985, 0.0127807118346497, &
    0.0117653516264543, 0.0107371261789923, 0.00969715984169461, &
    0.00864658980248223, 0.00758656484426889, 0.0065182440887831, &
    0.00544279572908601, 0.00436139575216976, 0.0032752266530317, &
    0.00218547614163489, 0.00109333584416427, 0.000136695007530996/)
  !
!  open(10,file='DATA',form='unformatted',access='direct',recl=144*96*4)
  open(10,file='DATA',form='unformatted',access='direct',recl=144*96*8)
  read(10) data2d
  close(10)
!  do j = 1,96
!     write(*,'(144f8.3)') (data2d(i,j),i=1,144)
!  enddo
  !
  call zonal_mean(data2d,zonal,gw,144,96)
  do j = 1,96
     write(*,'(f9.3)') zonal(j)
  enddo
  !
end program drive_zonal
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine zonal_mean(data_in,zonal,gw,nlon,nlat)
  implicit none
  !
  integer,parameter::real8 = selected_real_kind(15,128)
  integer::nlon,nlat,nlev
  real(real8),dimension(nlon,nlat)::data_in
  real(real8),dimension(nlat)     ::zonal,gw
  integer::i,j,k,kp,kpi
  !
  zonal = 0.
  do j = 1,nlat
!     zonal(j) = sum(data_in(:,j))*gw(j)
     zonal(j) = sum(data_in(:,j))/144
  enddo
!     zonal(j) = zonal(j)*0.5*gw(j)/144
!     zonal = zonal*0.5*gw
!  zonal = zonal/sum(gw)
end subroutine zonal_mean
@
